# -*- coding: utf-8 -*-
"""
@author: Antoni Vidal
"""
import sys
#sys.path.append('../postprocess')
from utils import get_td_power, get_td_time
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams
from scipy import interpolate
import random

#import scipy.io as sio
plt.close('all')
#%% ===========================================================================



params = {'backend': 'pdf',
#          'font.family': 'serif',
          'font.size': 14,
          'axes.labelsize': 12,
          'legend.fontsize': 10,
          'xtick.labelsize': 13,
          'ytick.labelsize': 13,
          'text.usetex': False,
          'lines.linewidth': 1.2,
          'lines.markersize': 3,
          'lines.markeredgewidth': 1,
          'legend.numpoints': 1, 
          'axes.formatter.useoffset': False,
          'figure.autolayout': True,
          }

rcParams.update(params)

x = [0.0, 0.25504607283896474,0.4408731899956124, 0.6267003071522601,
     0.8125274243089073, 0.998354541465555,1.1841816586222027, 1.3700087757788504,
     1.555835892935498,1.7416630100921457,1.9274901272487934,2.113317244405441,2.299144361562089,
     2.4849714787187365,2.670798595875384,2.856625713032032,3.0424528301886786,3.2282799473453263,
     3.414107064501974,3.5999341816586217,3.7857612988152693,3.971588415971917,4.157415533128565,
     4.343242650285212,4.52906976744186,4.714896884598508,4.900724001755155,5.086551118911803,
     5.272378236068451,5.4582053532250985,5.644032470381746,5.829859587538393,6.0156867046950415,
     6.201513821851688,6.387340939008337,6.573168056164984,6.758995173321632,6.944822290478279,
     7.130649407634928,7.316476524791574,7.502303641948221,7.68813075910487,7.8739578762615166,
     8.059784993418166,8.245612110574811,8.43143922773146,8.617266344888108,8.803093462044757,
     8.988920579201402,9.17474769635805,9.360574813514699,9.546401930671347,9.732229047827992,
     9.918056164984641]

y = [1.0, 0.986399, 0.976198, 0.965026, 0.953230, 0.940531, 0.927832,
     0.914787, 0.901463, 0.887724, 0.873984, 0.859967, 0.845811, 0.831308,
     0.817014, 0.802650, 0.788355, 0.773991, 0.759696, 0.745263, 0.730899,
     0.716673, 0.702448, 0.688292, 0.674483, 0.660813, 0.647143, 0.633542,
     0.619941, 0.606896, 0.593989, 0.580874, 0.568383, 0.555962, 0.543680,
     0.531328, 0.519532, 0.507735, 0.496285, 0.484766, 0.473802, 0.462769,
     0.452152, 0.441605, 0.431335, 0.421065, 0.411281, 0.401566, 0.392198,
     0.382830, 0.373670, 0.364788, 0.356184, 0.347718]



f = interpolate.interp1d(x, y)
xnew = np.arange(0, 10, 0.1)
ynew = f(xnew)   

ynew1 = (ynew - 1.0) *  0.99 + 1.0

ynew2 = (ynew - 1.0) * 0.985 +  + 1.0 + random.random()*0.002 * xnew

#%% ===========================================================================

## PlotS
fig = plt.figure()
ax = fig.add_subplot(1, 1, 1)
# ax.plot(time, power, label='Î”t = 0.1 s')
ax.plot(xnew, ynew1,  label='Diffusion')
ax.plot(xnew, ynew2,  label='SP3')
ax.grid(True)
ax.legend()
ax.set_xlabel('t (s)')
ax.set_ylabel('Relative Power Central')
fig.savefig('power_Central.pdf', format='pdf')


np.savetxt('blokage/t.txt', xnew)
np.savetxt('blokage/sp1_p10.txt', ynew1)
np.savetxt('blokage/sp3_p10.txt', ynew2)
